<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no" /> 
    <title>주차잇슈</title>
    <!-- CSS 파일 연결 -->
    <link rel="stylesheet" href="assets/css/login.css">
    <link rel="icon" href="images/parkingissue-favicon-16x16.png"/>
    <link rel="apple-touch-icon" href="images/parkingissue-apple-icon.png"/>
    <script src="https://kit.fontawesome.com/eb9b7241dc.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://static.nid.naver.com/js/naverLogin_implicit-1.0.3.js" charset="utf-8"></script>
</head>

<body>
    <div class="container">
        <!-- Heading -->
        <h1>주차잇슈</h1>
        
        <!-- Links -->
        <ul class="links">
            <li>
                <a href="#" id="personal_user" class="active">개인 회원</a>
            </li>
            <li>
                <a href="#" id="enterprise_user">기업 회원</a>
            </li>
            <li>
                <a href="./membership/personal/index.html" id="reset">회원가입</a>
            </li>
        </ul>
        
        <!-- Form -->
        <form  action="" method="post" id="login_form">
        <!-- id input -->
            <div class="first-input input__block first-input__block">
                <input type="id" placeholder="Id" class="input" id="id"   />
            </div>
            <!-- password input -->
            <div class="input__block">
                <input type="password" placeholder="Password" class="input" id="password" autocomplete="new-password">
            </div>
            <!-- repeat password input -->
            <div class="input__block">
                <input type="password" placeholder="Repeat password" class="input repeat__password" id="repeat__password" autocomplete="new-password">
            </div>
            <button class="signin__btn" id="loginbtn">
                Sign in
            </button>
        </form>
    <script>
        // 모든 링크를 선택
        const links = document.querySelectorAll('.links li a');
        const resetLink = document.getElementById('reset');
        // 링크 클릭 이벤트 처리
        links.forEach(link => {
            link.addEventListener('click', () => {
                // 모든 링크에서 active 클래스 제거
                links.forEach(link => link.classList.remove('active'));                
                // 현재 클릭된 링크에 active 클래스 추가
                link.classList.add('active');
                
                // 특정 동작 추가: placeholder 값 변경
                const idInput = document.getElementById('id');
                if (link.id === 'personal_user') {
                    idInput.placeholder = "Id"; // 개인회원
                    resetLink.href = "./membership/personal/index.html"; // 개인회원 가입 링크
                } else if (link.id === 'enterprise_user') {
                    idInput.placeholder = "기업회원 Id"; // 기업회원
                    resetLink.href = "./membership/enterprise/index.html"; // 기업회원 가입 링크
                }
            });
        });
        const loginForm = document.querySelector('form'); // form 요소 선택
        const loginBtn = document.getElementById('loginbtn');
        loginBtn.addEventListener('submit', (event) => {
            event.preventDefault();
            const id = document.getElementById('id').value;
            const pw = document.getElementById('password').value;
            const loginurl = 'https://parkingissue.online/api/login/';
            if (link.id === 'personal_user') {
                loginurl = 'https://parkingissue.online/api/login/common/personal';
                fetch (loginurl, {
                method: 'POST',
                headers: {
                    'accept': 'application/json',
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify ({
                    'user_id': id,
                    'user_pw': pw,
                }),
            })
            } else if (link.id === 'enterprise_user') {
                loginurl = 'https://parkingissue.online/api/login/common/enterprise';
                fetch (loginurl, {
                method: 'POST',
                headers: {
                    'accept': 'application/json',
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify ({
                    'manager_id': id,
                    'manager_pw': pw,
                }),
            })
            }
            
            .then (postResponse => {
                if(!postResponse.ok) {
                    throw new Error(`POST Request failed: ${postResponse.status}`);
                }
                else if (postResponse.ok) {
                    response.json().then(data => {
                        localStorage.setItem('token', data.token);
                        window.location.href = "./index.html";
                    });
                };
            }).catch(error => {
                console.error('로그인 요청 실패:', error);
            });
        })      
    </script>
        <!-- separator -->
        <div class="separator">
        <p>OR</p>
        </div>
        <div class="button-container">
            <button class="kakao__btn">
                <i class="fa fa-kakao"></i> 
                <!-- <img src="img/kakao-logo.png" style="width: 40px; height: 40px;"> -->
            </button>
            <div id="naver_id_login">
                <img id="NaverLoginBtn" src="./images/naver-logo.png" style="width: 50px; height: 50px; cursor: pointer;" alt="네이버 로그인">
            </div>
            
            
        </div>
    </div>
    
    <footer>
        <p>
        SAMDULSHOP : FINAL PROJECT
        <!-- <i class="fa fa-heart"></i> 
        <i class="fa fa-heart"></i> 
        <i class="fa fa-heart"></i>  -->
        </p>
        <p>
            인생한방 :
        <!-- <a href="https://www.facebook.com/chouaib45" >
            <i class="fa fa-facebook"></i>
        </a>
        <a href="http://twitter.com/chouaibblgn45">
            <i class="fa fa-twitter"></i> 
        </a>
        <a href="http://instagram.com/chouaib_blgn">
            <i class="fa fa-instagram"></i> 
        </a>
        <a href="http://linkedin.com/in/chouaibblgn/">
            <i class="fa fa-linkedin"></i>
        </a>
        <a href="https://www.behance.net/geek30">
            <i class="fa fa-behance"></i>
        </a> -->

            <i class="fa fa-github"></i>
        </a>
        </p>
    </footer>
</body>